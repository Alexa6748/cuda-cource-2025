# Lab 4: Radix Sort - Поразрядная сортировка

## Описание
В лабораторной работе реализован алгоритм поразрядной сортировки Radix Sort на CUDA для целых чисел 32-бит и 64-бит. 

**Что было сделано:**
- GPU-реализация Radix Sort с radix = 256 (8 бит за проход).
- Обработка положительных и отрицательных чисел через инверсию MSB (знакового бита) перед сортировкой и восстановлением после.
- Оптимизации: 
  - Warp-level гистограммы в shared memory с использованием `__shfl_sync` и `__popc` для минимизации bank conflicts.
  - Параллельный префиксный суммирующий скан (Blelloch scan) на блоках и по цифрам.
  - Scatter-ядро с локальными подсчетами в warp.
- Поддержка массивов от 10⁵ до 2×10⁶ элементов.
- Сравнение производительности CPU и GPU.
- 64-битная поддержка.

## Компиляция
```bash
make
```

## Запуск
```bash
./program
```

## Результаты

<img width="743" height="584" alt="image" src="https://github.com/user-attachments/assets/eb3f7cf4-23ae-457f-898b-bf118edfb608" />
<img width="314" height="449" alt="image" src="https://github.com/user-attachments/assets/188fd491-3340-493b-a231-5525284cfdce" />



### Производительность (Kernel Time)
| Размер     | Тип    | CPU std::sort (мс) | GPU Radix Sort (мс) | Ускорение vs CPU | Thrust::sort (мс) |
|------------|--------|--------------------|---------------------|------------------|-------------------|
| 100 000    | int32  | 12.66             | **0.55**           | **22.8x**       | 0.78             |
| 100 000    | int64  | 4.87              | **0.47**           | **10.3x**       | 0.34             |
| 500 000    | int32  | 28.22             | **0.75**           | **37.8x**       | 0.28             |
| 500 000    | int64  | 27.86             | **1.17**           | **23.8x**       | 0.41             |
| 1 000 000  | int32  | 59.25             | **1.26**           | **46.9x**       | 0.42             |
| 1 000 000  | int64  | 72.63             | **2.15**           | **33.7x**       | 0.69             |
| 2 000 000  | int32  | 142.35            | **2.15**           | **66.1x**       | 0.55             |
| 2 000 000  | int64  | 141.84            | **4.45**           | **31.9x**       | 1.54             |

**Выводы:**
- GPU Radix Sort даёт ускорение от 10x до 66x по сравнению со CPU. Максимальное ускорение наблюдается на больших массивах (2M элементов)
- Корректность: PASSED для всех 8 тестов.
- При сравнении с Thrust::sort на небольших массивах (100k) реализация быстрее (0.55 мс против 0.78 мс для int32). Но начиная с 500k–1M элементов Thrust начинает выигрывать, а на 2M элементах преимущество достигает 2–4 раз (2.15 мс vs 0.55 мс для int32). Такой результат вполне ожидаем. Thrust::sort использует высокооптимизированный внутренний движок CUB, который содержит множество низкоуровневых оптимизаций и autotuning.

## Замечания
### Особенности реализации
- `flip_msb` корректно обрабатывает отрицательные числа (инверсия знакового бита).
- Все оптимизации warp-level + Blelloch scan работают без атомиков.
- 4 прохода (int32), 8 проходов (int64).

### Ограничения
- Только целые числа (int32/int64).
- Максимальный тестированный размер — 2M элементов.
