# Lab 2: Matrix Multiplication - Перемножение матриц

## Описание
Реализована программа для умножения матриц на CUDA.  
Поддерживаются как квадратные, так и прямоугольные матрицы произвольных размеров (от малых до 4096×4096, ограничено только объёмом памяти GPU).  

Реализовано три версии вычислений:
- Наивная CPU-версия (трёхвложенные циклы).
- Базовая GPU-версия (простое ядро без оптимизаций).
- Оптимизированная GPU-версия с использованием shared memory и тайлингом (TILE_SIZE = 32).

Программа измеряет время выполнения каждой версии, сравнивает результаты GPU с эталонными CPU-результатами (с epsilon = 1e-3f) и выводит ускорение относительно CPU.  
Матрицы заполняются случайными значениями в диапазоне [0, 1).

Корректность проверена на разных размерах, включая прямоугольные матрицы. Реализован тайлинг с shared memory (TILE_SIZE=32), коалесцированный доступ.

## Компиляция
```bash
make
```

Для очистки:
```bash
make clean
```

## Запуск
```bash
./program [M N K] [--mode cpu|gpu_basic|gpu_shared|all]
```

- Без аргументов — квадратные матрицы 1024×1024 (по умолчанию).
- Пример прямоугольных: `./program 1000 2000 1500`
- Режим `--mode all` запускает все версии (по умолчанию).

## Результаты
Программа выводит размеры матриц, время выполнения и ускорение.  
Результаты GPU сравниваются с CPU (epsilon = 1e-3f из-за особенностей float-арифметики).

### Примеры работы программы

#### Маленькие матрицы (4×4×4)
<img width="899" height="326" alt="image" src="https://github.com/user-attachments/assets/a50f25a0-c1bd-4fed-af44-1a1b02c509fb" />


#### Средние матрицы (100×200×300)
<img width="689" height="259" alt="image" src="https://github.com/user-attachments/assets/2577924b-432c-45f7-873d-e0228c8aaadb" />


#### Прямоугольные матрицы (64×256×128)
<img width="649" height="231" alt="image" src="https://github.com/user-attachments/assets/190b74c8-cccc-450c-923e-23888bc8c29a" />


#### Большие матрицы (1000×2000×1500)
<img width="654" height="231" alt="image" src="https://github.com/user-attachments/assets/fbcb4570-c975-4834-9b81-bd7438f4445d" />


#### Квадратные матрицы по умолчанию (1024×1024)
<img width="556" height="233" alt="image" src="https://github.com/user-attachments/assets/768aefb4-02bb-4503-b932-39f63dc33fc6" />


## Замечания
- Оптимизированная версия (shared memory) даёт заметное ускорение на матрицах:

| Размер матриц          | Коэффициент (shared быстрее basic в N раз) |
|-----------------------|--------------------------------------------|
| 4×4×4                 | ≈4.00x                                     |
| 100×200×300           | ≈3.56x                                     |
| 64×256×128            | ≈3.70x                                     |
| 1000×2000×1500        | ≈1.48x                                     |
| 1024×1024             | ≈1.7x                                     |

- Для малых матриц GPU-версии медленнее CPU из-за накладных расходов на запуск ядра и копирование данных.
- Сравнение результатов выполняется с epsilon = 1e-3f, что учитывает накопленные ошибки округления в арифметике одинарной точности (float). 
- Генерация случайных чисел — в диапазоне [0, 1), чтобы минимизировать ошибки округления.
- Программа корректно освобождает всю выделенную память (cudaFree, free).
